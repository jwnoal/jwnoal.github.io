---
title: "微信公众号网页授权登录公用"
pubDate: 2024-04-26
draft: false
description: "微信公众号网页授权登录公用"
tags: ["h5", "vue", "wechat"]
---

只需在微信公众号后台安全域名配置域名  
然后在登录页跳转此代码的页面就能把 code 带回去  
``/authorize?url=${location.href}&appid=xxx``

```vue
<template>
  <div class="authorize">
    <div class="content wx">
      <div class="title">微信授权登录</div>
      <img src="@/assets/images/common/wx.png" alt="wx" />
    </div>
  </div>
</template>
<script setup lang="ts">
import { GetUrlParams } from "@/utils/Util";

if (GetUrlParams().code) {
  location.href =
    sessionStorage.getItem("redirectUri") + "?code=" + GetUrlParams().code;
} else {
  const url = GetUrlParams().url;
  sessionStorage.setItem("redirectUri", url);

  const REDIRECT_URI = location.href;
  window.location.href = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=${
    GetUrlParams().appid
  }&redirect_uri=${encodeURIComponent(
    REDIRECT_URI
  )}&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect`;
}
</script>

<style lang="scss">
.authorize {
  padding-top: 88px;
  background: url("@/assets/images/mine/bg-login.jpg") no-repeat;
  background-size: 100% auto;
  min-height: 100vh;
  .content {
    padding: 36px;
    padding-top: 216px;
    .title {
      font-size: 40px;
      font-weight: bold;
      margin-bottom: 42px;
    }
  }
  .wx {
    text-align: center;
    font-size: 36px !important;
    img {
      margin: auto;
      width: 64px;
      height: 64px;
    }
  }
}
</style>
```
